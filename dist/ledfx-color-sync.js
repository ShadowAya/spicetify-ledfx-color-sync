(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));function D(e,t){return e<t?-1:t<e?1:0}function o(e){return e.reduce(function(e,t){return e+t},0)}var e,t,B=Object.create,r=Object.defineProperty,H=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,U=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty,l=(e,t,l)=>(l=null!=e?B(U(e)):{},((t,l,o,n)=>{if(l&&"object"==typeof l||"function"==typeof l)for(let e of a(l))V.call(t,e)||e===o||r(t,e,{get:()=>l[e],enumerable:!(n=H(l,e))||n.enumerable});return t})(!t&&e&&e.__esModule?l:r(l,"default",{value:e,enumerable:!0}),e)),n=(e={"external-global-plugin:react"(e,t){t.exports=Spicetify.React}},function(){return t||(0,e[a(e)[0]])((t={exports:{}}).exports,t),t.exports}),R=(()=>{function e(e){this.colors=e}var t=e.prototype;return t.palette=function(){return this.colors},t.map=function(e){return e},e})(),T=(C.prototype={volume:function(e){var t=this;return t._volume&&!e||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(e){var t=this,l=t.histo;if(!t._count_set||e){for(var o,n,r=0,a=t.r1;a<=t.r2;a++)for(o=t.g1;o<=t.g2;o++)for(n=t.b1;n<=t.b2;n++)r+=l[w(a,o,n)]||0;t._count=r,t._count_set=!0}return t._count},copy:function(){var e=this;return new C(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(e){var t=this,l=t.histo;if(!t._avg||e){var o,n,r,a,i=0,c=0,s=0,d=0;if(t.r1===t.r2&&t.g1===t.g2&&t.b1===t.b2)t._avg=[t.r1<<3,t.g1<<3,t.b1<<3];else{for(n=t.r1;n<=t.r2;n++)for(r=t.g1;r<=t.g2;r++)for(a=t.b1;a<=t.b2;a++)i+=o=l[w(n,r,a)]||0,c+=o*(n+.5)*8,s+=o*(r+.5)*8,d+=o*(a+.5)*8;t._avg=i?[~~(c/i),~~(s/i),~~(d/i)]:[~~(8*(t.r1+t.r2+1)/2),~~(8*(t.g1+t.g2+1)/2),~~(8*(t.b1+t.b2+1)/2)]}}return t._avg},contains:function(e){var t=this,l=e[0]>>3;return gval=e[1]>>3,bval=e[2]>>3,l>=t.r1&&l<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},M.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,l=0;l<t.size();l++)if(t.peek(l).vbox.contains(e))return t.peek(l).color;return this.nearest(e)},nearest:function(e){for(var t,l,o,n=this.vboxes,r=0;r<n.size();r++)((l=Math.sqrt(Math.pow(e[0]-n.peek(r).color[0],2)+Math.pow(e[1]-n.peek(r).color[1],2)+Math.pow(e[2]-n.peek(r).color[2],2)))<t||void 0===t)&&(t=l,o=n.peek(r).color);return o},forcebw:function(){var e=this.vboxes,t=(e.sort(function(e,t){return D(o(e.color),o(t.color))}),e[0].color),t=(t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]),e.length-1),l=e[t].color;251<l[0]&&251<l[1]&&251<l[2]&&(e[t].color=[255,255,255])}},function(e,t){if(!Number.isInteger(t)||t<1||256<t)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!e.length||t<2||256<t)return!1;if(!e.length||t<2||256<t)return!1;for(var l=[],o=new Set,n=0;n<e.length;n++){var r=e[n],a=r.join(",");o.has(a)||(o.add(a),l.push(r))}if(l.length<=t)return new R(l);h=e,c=new Array(32768),h.forEach(function(e){i=w(e[0]>>3,e[1]>>3,e[2]>>3),c[i]=(c[i]||0)+1});var i,c,s,d,u,_,f,p,g,m=c,h=(m.forEach(function(){}),h=m,p=_=d=1e6,g=f=u=0,e.forEach(function(e){(s=e[0]>>3)<d?d=s:u<s&&(u=s),(s=e[1]>>3)<_?_=s:f<s&&(f=s),(s=e[2]>>3)<p?p=s:g<s&&(g=s)}),new C(d,u,_,f,p,g,h)),x=new S(function(e,t){return D(e.count(),t.count())});function y(e,t){for(var l,o=e.size(),n=0;n<1e3;){if(t<=o)return;if(1e3<n++)return;if((l=e.pop()).count()){var r=((e,t)=>{if(t.count()){var l=t.r2-t.r1+1,o=t.g2-t.g1+1,n=Math.max.apply(null,[l,o,t.b2-t.b1+1]);if(1==t.count())return[t.copy()];var r,a,i,c,s=0,d=[],u=[];if(n==l)for(r=t.r1;r<=t.r2;r++){for(c=0,a=t.g1;a<=t.g2;a++)for(i=t.b1;i<=t.b2;i++)c+=e[w(r,a,i)]||0;d[r]=s+=c}else if(n==o)for(r=t.g1;r<=t.g2;r++){for(c=0,a=t.r1;a<=t.r2;a++)for(i=t.b1;i<=t.b2;i++)c+=e[w(a,r,i)]||0;d[r]=s+=c}else for(r=t.b1;r<=t.b2;r++){for(c=0,a=t.r1;a<=t.r2;a++)for(i=t.g1;i<=t.g2;i++)c+=e[w(a,i,r)]||0;d[r]=s+=c}d.forEach(function(e,t){u[t]=s-e});var _,f,p,g,m,l=n==l?"r":n==o?"g":"b",h=l+"1",x=l+"2",y=0;for(r=t[h];r<=t[x];r++)if(s/2<d[r]){for(p=t.copy(),g=t.copy(),m=(_=r-t[h])<=(f=t[x]-r)?Math.min(t[x]-1,~~(r+f/2)):Math.max(t[h],~~(r-1-_/2));!d[m];)m++;for(y=u[m];!y&&d[m-1];)y=u[--m];return p[x]=m,g[h]=p[x]+1,[p,g]}}})(m,l),a=r[0],r=r[1];if(!a)return;e.push(a),r&&(e.push(r),o++)}else e.push(l),n++}}x.push(h),y(x,.75*t);for(var v=new S(function(e,t){return D(e.count()*e.volume(),t.count()*t.volume())});x.size();)v.push(x.pop());y(v,t);for(var b=new M;v.size();)b.push(v.pop());return b});function w(e,t,l){return(e<<10)+(t<<5)+l}function S(e){var t=[],l=!1;function o(){t.sort(e),l=!0}return{push:function(e){t.push(e),l=!1},peek:function(e){return l||o(),t[e=void 0===e?t.length-1:e]},pop:function(){return l||o(),t.pop()},size:function(){return t.length},map:function(e){return t.map(e)},debug:function(){return l||o(),t}}}function C(e,t,l,o,n,r,a){var i=this;i.r1=e,i.r2=t,i.g1=l,i.g2=o,i.b1=n,i.b2=r,i.histo=a}function M(){this.vboxes=new S(function(e,t){return D(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function c(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=e.naturalWidth,this.height=this.canvas.height=e.naturalHeight,this.context.drawImage(e,0,0,this.width,this.height)}function s(){}c.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},s.prototype.getColor=function(e,t){return this.getPalette(e,5,t=void 0===t?10:t)[0]},s.prototype.getPalette=function(e,t,l){t=(e=>{var t=e.colorCount,e=e.quality;if(void 0!==t&&Number.isInteger(t)){if(1===t)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");t=Math.max(t,2),t=Math.min(t,20)}else t=10;return{colorCount:t,quality:e=void 0===e||!Number.isInteger(e)||e<1?10:e}})({colorCount:t,quality:l}),l=new c(e),e=((e,t,l)=>{for(var o,n,r,a,i=e,c=[],s=0;s<t;s+=l)o=i[0+(a=4*s)],n=i[1+a],r=i[2+a],!(void 0===(a=i[3+a])||125<=a)||250<o&&250<n&&250<r||c.push([o,n,r]);return c})(l.getImageData().data,l.width*l.height,t.quality),l=T(e,t.colorCount);return l?l.palette():null},s.prototype.getColorFromUrl=function(t,l,o){var n=this,r=document.createElement("img");r.addEventListener("load",function(){var e=n.getPalette(r,5,o);l(e[0],t)}),r.src=t},s.prototype.getImageData=function(e,n){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){if(200==this.status){var e=new Uint8Array(this.response);i=e.length;for(var t=new Array(i),l=0;l<e.length;l++)t[l]=String.fromCharCode(e[l]);var o=t.join(""),o=window.btoa(o);n("data:image/png;base64,"+o)}},t.send()},s.prototype.getColorAsync=function(e,l,o){var n=this;this.getImageData(e,function(e){var t=document.createElement("img");t.addEventListener("load",function(){var e=n.getPalette(t,5,o);l(e[0],this)}),t.src=e})};var I={background_color:["gradient","fade","rainbow","random_flash","singleColor","bar","multiBar","strobe","blade_power_plus","energy","magnitude","pitchSpectrum","power","rain","real_strobe","scan","scan_and_flare","scan_multi","scroll","scroll_plus","spectrum","wavelength","block_reflections","crawler","energy2","fire","glitch","lava_lamp","marching","melt","melt_and_sparkle","water","bands","bands_matrix","blocks","equalizer","equalizer2d","noise2d","plasma2d","plasmawled","texter2d","metro","pixels"],gradient:["gradient","fade","bar","multiBar","strobe","blade_power_plus","magnitude","pitchSpectrum","power","real_strobe","scan","scan_and_flare","scan_multi","wavelength","block_reflections","crawler","energy2","fire","glitch","lava_lamp","marching","melt","melt_and_sparkle","water","bands","bands_matrix","blocks","equalizer","digitalrain2d","equalizer2d","noise2d","plasma2d","plasmawled","texter2d"],hit_color:["random_flash"],color:["singleColor"],color_high:["energy","rain","scan_multi","scroll","scroll_plus","vumeter"],color_lows:["energy","rain","scan_multi","scroll","scroll_plus"],color_mids:["energy","rain","scan_multi","scroll","scroll_plus","vumeter"],sparks_color:["power"],strobe_color:["real_strobe"],color_scan:["scan","scan_and_flare"],text_color:["texter2d"],flash_color:["metro"],pixel_color:["pixels"],color_max:["vumeter"],color_min:["vumeter"]},A={gradient:"Gradient",fade:"Fade",rainbow:"Rainbow",random_flash:"Random Flash",singleColor:"Single Color",bar:"Bar",multiBar:"Multicolor Bar",strobe:"BPM Strobe",blade_power_plus:"Blade Power+",energy:"Energy",magnitude:"Magnitude",pitchSpectrum:"Pitch Spectrum",power:"Power",rain:"Rain",real_strobe:"Strobe",scan:"Scan",scan_and_flare:"Scan and Flare",scan_multi:"Scan Multi",scroll:"Scroll",scroll_plus:"Scroll+",spectrum:"Spectrum",wavelength:"Wavelength",block_reflections:"Block Reflections",crawler:"Crawler",energy2:"Energy 2",fire:"Fire",glitch:"Glitch",lava_lamp:"Lava Lamp",marching:"Marching",melt:"Melt",melt_and_sparkle:"Melt and Sparkle",water:"Water",bands:"Bands",bands_matrix:"Bands Matrix",blocks:"Blocks",equalizer:"Equalizer",digitalrain2d:"Digital Rain",equalizer2d:"Equalizer2d",noise2d:"Noise",plasma2d:"Plasma",plasmawled:"PlasmaWled2d",texter2d:"Texter",metro:"Metro",pixels:"Pixels",vumeter:"VuMeter"};function d(e){return Math.min(255,Math.max(0,e))}function Q(e,t,l){return("#"+d(e).toString(16).padStart(2,"0")+d(t).toString(16).padStart(2,"0")+d(l).toString(16).padStart(2,"0")).toUpperCase()}function x(e,t,l){return`rgb(${e}, ${t}, ${l})`}function Z([e,t,l]){return.299*e+.587*t+.114*l}function u(e){if(e)return 128<Z(e)?"#000000":"#ffffff"}function G(e,t,l,o){e=Math.min(1,Math.max(.001,(e-t)/(l-t)));return Math.pow(e,o)}var Y=0,K=90,J=0,X=.9;function $(e,t=!1){function l(e,t=!1){var l,o=Z(e),n=([n,r,a]=[e][0],(Math.max(n,r,a)-Math.min(n,r,a))/255),r=Math.min(G(o,Y,K,3),.5),a=G(n,J,X,1.1),i=Math.max(a*r,1e-5);return t&&(t=r,r=o,o=a,a=n,n=i,l=x(...e=e),console.log("%c          ",`background: ${l}; font-size: 20px;`),console.table({"Color (RGB)":[e.join(", ")],Luminance:[r,t],Saturation:[a,o],Priority:[n]})),i}e=e.sort((e,t)=>l(t)-l(e));if(t)for(var o of e)l(o,!0);return e}function _(t,l){var e;if("number"==typeof t)return Q((e=l[t])[0],e[1],e[2]);{if(Object.keys(t).length<2)return null;let e="linear-gradient(90deg, ";for(var[o,n]of Object.entries(t)){n=l[n];e+=`${x(n[0],n[1],n[2])} ${o}%, `}return e=e.slice(0,-2)+")"}}async function W(e){o=e;var o,l,e=await new Promise(t=>{let l=new MutationObserver(()=>{e()}),e=()=>{var e=document.querySelector(o);e&&(l.disconnect(),t(e))};e(),setTimeout(()=>{l.disconnect(),t(null)},5e3),l.observe(document.body,{childList:!0,subtree:!0})});return e?(l=e,await new Promise((e,t)=>{l.complete?e(l):(l.onload=()=>e(l),l.onerror=()=>t(new Error("Image failed to load")))}),e.crossOrigin="anonymous",e):null}var ee=`
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"
              "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">

<svg xmlns="http://www.w3.org/2000/svg"
     viewBox="0 0 512 512">
  <path id="ring copy"
        fill="currentColor" stroke="none" stroke-width="0.3"
        d="M 240.00,0.21
           C 240.00,0.21 264.00,0.21 264.00,0.21
             264.00,0.21 276.00,0.91 276.00,0.91
             300.87,2.65 324.65,8.22 348.00,16.95
             373.01,26.30 398.45,41.27 419.00,58.25
             439.59,75.27 457.63,95.40 471.95,118.00
             534.76,217.17 522.88,344.95 443.09,431.00
             423.70,451.91 400.58,469.96 375.00,482.75
             330.78,504.88 295.27,512.57 246.00,512.00
             246.00,512.00 236.00,511.09 236.00,511.09
             215.63,509.66 195.41,505.80 176.00,499.33
             139.83,487.29 108.97,469.02 81.00,443.09
             81.00,443.09 74.17,436.91 74.17,436.91
             31.81,393.29 5.16,336.79 0.91,276.00
             0.91,276.00 0.00,264.00 0.00,264.00
             0.00,264.00 0.00,248.00 0.00,248.00
             0.00,248.00 0.91,236.00 0.91,236.00
             2.95,206.83 10.08,177.63 22.31,151.00
             51.84,86.67 103.14,38.48 170.00,14.69
             186.39,8.86 203.75,4.61 221.00,2.28
             221.00,2.28 240.00,0.21 240.00,0.21 Z
           M 242.00,29.28
           C 242.00,29.28 231.00,30.28 231.00,30.28
             218.22,31.81 205.36,34.04 193.00,37.72
             132.06,55.88 81.40,96.83 52.81,154.00
             6.58,246.46 28.92,359.80 107.00,427.71
             129.44,447.24 155.83,461.94 184.00,471.33
             201.34,477.11 218.78,480.76 237.00,482.09
             237.00,482.09 247.00,483.00 247.00,483.00
             286.55,483.46 322.31,477.04 358.00,459.19
             382.58,446.90 403.12,430.79 422.04,411.00
             501.64,327.75 502.89,193.43 427.71,107.00
             399.89,75.01 366.02,53.34 326.00,40.00
             301.81,31.94 267.42,26.92 242.00,29.28 Z
           M 83.53,154.27
           C 83.53,154.27 285.89,154.26 285.89,154.26
             285.89,154.26 330.94,214.78 330.94,214.78
             330.94,214.78 375.99,154.26 375.99,154.26
             375.99,154.26 436.76,154.26 436.76,154.26
             436.76,154.26 361.31,255.61 361.31,255.61
             361.31,255.61 436.76,356.97 436.76,356.97
             436.76,356.97 375.99,356.97 375.99,356.97
             375.99,356.97 330.94,296.44 330.94,296.44
             330.94,296.44 285.89,356.97 285.89,356.97
             285.89,356.97 225.02,356.99 225.02,356.99
             225.02,356.99 300.56,255.62 300.56,255.62
             300.56,255.62 255.48,195.06 255.48,195.06
             255.48,195.06 113.92,194.99 113.92,194.99
             113.92,194.99 83.53,154.27 83.53,154.27 Z
           M 134.97,357.03
           C 134.97,357.03 74.24,356.95 74.24,356.95
             74.24,356.95 154.32,249.42 154.32,249.42
             154.32,249.42 128.52,214.73 128.52,214.73
             128.52,214.73 240.85,214.78 240.85,214.78
             240.85,214.78 271.16,255.54 271.16,255.54
             271.16,255.54 210.51,255.54 210.51,255.54
             210.51,255.54 134.97,357.03 134.97,357.03 Z" />
</svg>
`,y=l(n()),te=l(n()),le=e=>{let[t,o]=(0,te.useState)(()=>e.getAll());(0,te.useEffect)(()=>{let e=({detail:t})=>{o(e=>({...e,[t.key]:t.value}))};return document.addEventListener("LedFxConfigUpdated",e),()=>{document.removeEventListener("LedFxConfigUpdated",e)}},[]);return{configData:t,setValue:(t,l)=>{e.set(t,l),o(e=>({...e,[t]:l}))},getValue:e=>t[e]}},v={input:"SettingsModal-module__input___v8E2s_ledfxDcolorDsync",parent:"SettingsModal-module__parent___oVk1A_ledfxDcolorDsync",inputContainer:"SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync",colorDisplay:"SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync",toggle:"SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync",subtitle:"SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync",saveButtons:"SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync",staticField:"SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync",field:"SettingsModal-module__field___qw0nl_ledfxDcolorDsync"},oe={lows_color:"color_lows",mids_color:"color_mids",high_color:"color_high",color_low:"color_lows",color_mid:"color_mids",color_peak:"color_high"},b=class{constructor(e){this.config=e}urlOrNull(){var e=this.config.get("ledFxUrl");return e?`${e=e,(e=e.trim()).endsWith("/")?e.slice(0,-1):e}/api`:null}async makeRequest(e,t,l){var o=this.urlOrNull();if(!o)return null;try{var n,r=await fetch(o+"/"+e,{method:t,headers:{"Content-Type":"application/json"},body:l?JSON.stringify(l):void 0});return r.ok?(n=await r.json()).status&&"success"!==n.status?null:n:null}catch{return null}}async listDevices(){var e;return this.urlOrNull()&&(e=await this.makeRequest("devices","GET"))?Object.entries(e.devices).map(([e,t])=>({id:e,name:t.config.name})):null}async listVirtuals(){var e;return this.urlOrNull()&&(e=await this.makeRequest("virtuals","GET"))?Object.keys(e.virtuals):null}async getEffect(e){return(e=e||(this.config.config.deviceId??void 0))&&this.urlOrNull()&&(e=await this.makeRequest(`virtuals/${e}/effects`,"GET"))?e.effect:null}async setEffectColors(e,t){var l=await this.getEffect(e);if(!l)return!1;var o={config:{},type:l?.type},n=this.config.config.presets[this.config.config.selectedPreset].colorData;let r=(e=>e=((e,t,l)=>(e=Object.entries(e).filter(([e,t])=>l(e,t)),"k"===t?e.map(([e])=>e):"v"===t?e.map(([,e])=>e):Object.fromEntries(e)))(e.config,"k",(e,t)=>"string"==typeof t&&(t.includes("#")||t.includes("linear-gradient(90deg"))))(l);var a,i,c,l=Object.keys(oe).filter(e=>r.includes(e));for([a,i]of Object.entries(n)){var s=_(i,t);s&&r.includes(a)&&(o.config[a]=s)}for(c of l){var d=_(n[oe[c]],t);d&&(o.config[c]=d)}return null!==await this.makeRequest(`virtuals/${e}/effects`,"PUT",o)}},ne=l(n());function re(){let[e,t]=(0,ne.useState)(null);return(0,ne.useEffect)(()=>{let e=e=>{t(e.detail)};return document.addEventListener("albumColorUpdated",e),()=>{document.removeEventListener("albumColorUpdated",e)}},[]),e}var f=l(n()),p={input:"SettingsModal-module__input___v8E2s_ledfxDcolorDsync",parent:"SettingsModal-module__parent___oVk1A_ledfxDcolorDsync",inputContainer:"SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync",colorDisplay:"SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync",toggle:"SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync",subtitle:"SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync",saveButtons:"SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync",staticField:"SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync",field:"SettingsModal-module__field___qw0nl_ledfxDcolorDsync"},ae=Spicetify.classnames,ie=e=>""===e;function ce({objKey:l,value:e,originalValue:o,options:t,setFn:n,error:r,noNull:a,label:i}){let c=t.map(e=>e.value);return f.default.createElement("div",{className:p.inputContainer},f.default.createElement("label",null,i||L[l]),r?f.default.createElement("input",{className:ae(p.input,"main-dropDown-dropDown"),type:"text",style:{opacity:.6},value:r,disabled:!0}):f.default.createElement("select",{className:ae(p.input,"main-dropDown-dropDown"),value:e&&c.includes(e)?e:"",onChange:e=>{var t;t=l,e=e.target.value,ie(e)?o&&!c.includes(o)?n(l,o):n(l,null):n(t,e)}},!a&&f.default.createElement("option",{value:""}),t.map(e=>f.default.createElement("option",{value:e.value},f.default.createElement("span",null,e.title," ",e.subtitle&&f.default.createElement(f.default.Fragment,null,"(",e.subtitle,")"))))))}var g=l(n()),m={input:"SettingsModal-module__input___v8E2s_ledfxDcolorDsync",parent:"SettingsModal-module__parent___oVk1A_ledfxDcolorDsync",inputContainer:"SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync",colorDisplay:"SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync",toggle:"SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync",subtitle:"SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync",saveButtons:"SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync",staticField:"SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync",field:"SettingsModal-module__field___qw0nl_ledfxDcolorDsync"},h=Spicetify.classnames;function se({objKey:t,value:e,setFn:l,error:o}){return g.default.createElement("div",{className:m.inputContainer},g.default.createElement("label",null,L[t]),g.default.createElement("input",{className:h(m.input,m.field,"main-dropDown-dropDown"),type:"text",value:o??e??"",onChange:e=>l(t,e.target.value)}))}function de({value:e,label:t,setValue:l}){return g.default.createElement("div",{className:m.inputContainer},g.default.createElement("label",null,t),g.default.createElement("input",{className:h(m.input,m.field,"main-dropDown-dropDown"),type:"text",value:e??"",onChange:e=>l(e.target.value)}))}function ue({value:e,label:t}){return g.default.createElement("div",{className:m.inputContainer},g.default.createElement("label",null,t),g.default.createElement("input",{className:h(m.input,m.field,m.staticField,"main-dropDown-dropDown"),type:"text",value:e??"",readOnly:!0}))}var E=l(n()),_e={input:"SettingsModal-module__input___v8E2s_ledfxDcolorDsync",parent:"SettingsModal-module__parent___oVk1A_ledfxDcolorDsync",inputContainer:"SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync",colorDisplay:"SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync",toggle:"SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync",subtitle:"SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync",saveButtons:"SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync",staticField:"SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync",field:"SettingsModal-module__field___qw0nl_ledfxDcolorDsync"};function fe({objKey:t,value:e,setFn:l}){return E.default.createElement("div",{className:_e.toggle},E.default.createElement("input",{type:"checkbox",checked:!0===e,onChange:e=>l(t,e.target.checked)}),E.default.createElement("label",null,L[t]))}Spicetify.classnames;var k=l(n()),pe={container:"ColorsConfigMenu-module__container___A-ZV8_ledfxDcolorDsync",select:"ColorsConfigMenu-module__select___byko-_ledfxDcolorDsync",staticInput:"ColorsConfigMenu-module__staticInput___gUq2H_ledfxDcolorDsync"},N=l(n()),ge=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 24 24"},N.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),N.default.createElement("path",{fill:"currentColor",d:"M18.925 3.137a3.027 3.027 0 0 0-4.283.001l-9.507 9.52a3.03 3.03 0 0 0-.885 2.139V18c0 .414.336.75.75.75h3.223c.803 0 1.573-.32 2.14-.887l9.5-9.506a3.03 3.03 0 0 0 0-4.28zM4 20.25a.75.75 0 0 0 0 1.5h16a.75.75 0 0 0 0-1.5z"})),me=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 24 24"},N.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),N.default.createElement("path",{fill:"currentColor",d:"M7 21q-.825 0-1.412-.587T5 19V6q-.425 0-.712-.288T4 5t.288-.712T5 4h4q0-.425.288-.712T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5t-.288.713T19 6v13q0 .825-.587 1.413T17 21zm3-4q.425 0 .713-.288T11 16V9q0-.425-.288-.712T10 8t-.712.288T9 9v7q0 .425.288.713T10 17m4 0q.425 0 .713-.288T15 16V9q0-.425-.288-.712T14 8t-.712.288T13 9v7q0 .425.288.713T14 17"})),he=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 24 24"},N.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),N.default.createElement("g",{fill:"none"},N.default.createElement("path",{d:"m12.593 23.258-.011.002-.071.035-.02.004-.014-.004-.071-.035q-.016-.005-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427q-.004-.016-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093q.019.005.029-.008l.004-.014-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014-.034.614q.001.018.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z"}),N.default.createElement("path",{fill:"currentColor",d:"M10.5 20a1.5 1.5 0 0 0 3 0v-6.5H20a1.5 1.5 0 0 0 0-3h-6.5V4a1.5 1.5 0 0 0-3 0v6.5H4a1.5 1.5 0 0 0 0 3h6.5z"}))),xe=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 24 24"},N.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),N.default.createElement("g",{fill:"none",fillRule:"evenodd"},N.default.createElement("path",{d:"m12.593 23.258-.011.002-.071.035-.02.004-.014-.004-.071-.035q-.016-.005-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427q-.004-.016-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093q.019.005.029-.008l.004-.014-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014-.034.614q.001.018.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z"}),N.default.createElement("path",{fill:"currentColor",d:"M21.546 5.111a1.5 1.5 0 0 1 0 2.121L10.303 18.475a1.6 1.6 0 0 1-2.263 0L2.454 12.89a1.5 1.5 0 1 1 2.121-2.121l4.596 4.596L19.424 5.111a1.5 1.5 0 0 1 2.122 0"}))),ye=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 24 24"},N.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),N.default.createElement("g",{fill:"none",fillRule:"evenodd"},N.default.createElement("path",{d:"m12.593 23.258-.011.002-.071.035-.02.004-.014-.004-.071-.035q-.016-.005-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427q-.004-.016-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093q.019.005.029-.008l.004-.014-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014-.034.614q.001.018.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z"}),N.default.createElement("path",{fill:"currentColor",d:"m12 14.122 5.303 5.303a1.5 1.5 0 0 0 2.122-2.122L14.12 12l5.304-5.303a1.5 1.5 0 1 0-2.122-2.121L12 9.879 6.697 4.576a1.5 1.5 0 1 0-2.122 2.12L9.88 12l-5.304 5.304a1.5 1.5 0 1 0 2.122 2.12z"}))),ve=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 16 16"},N.default.createElement("path",{fill:"none",d:"M0 0h16v16H0z"}),N.default.createElement("path",{fill:"currentColor",d:"M5.465 9.83a.92.92 0 0 0 1.07-.001 1 1 0 0 0 .341-.459l.347-1.067a1.7 1.7 0 0 1 1.078-1.079l1.086-.353a.923.923 0 0 0-.037-1.75l-1.069-.346a1.7 1.7 0 0 1-1.08-1.078l-.353-1.084a.92.92 0 0 0-.869-.61.92.92 0 0 0-.875.624l-.356 1.09A1.71 1.71 0 0 1 3.7 4.775l-1.084.351a.923.923 0 0 0 .013 1.745l1.067.347a1.71 1.71 0 0 1 1.081 1.083l.352 1.08c.063.18.181.337.337.448m5.07 4.021a.8.8 0 0 0 .464.148.81.81 0 0 0 .759-.55l.248-.762c.053-.158.143-.303.26-.421s.262-.207.42-.259l.772-.252a.8.8 0 0 0-.023-1.521l-.764-.249a1.08 1.08 0 0 1-.68-.678l-.252-.774a.8.8 0 0 0-1.518.011l-.247.762a1.07 1.07 0 0 1-.664.679l-.776.253a.8.8 0 0 0-.388 1.221c.099.14.239.245.4.3l.763.247a1.08 1.08 0 0 1 .68.683l.253.774a.8.8 0 0 0 .292.388"})),be=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 12 12"},N.default.createElement("path",{fill:"none",d:"M0 0h12v12H0z"}),N.default.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:2,d:"M10 4c-.8-1.1-2-2.5-4.1-2.5-2.5 0-4.4 2-4.4 4.5s2 4.5 4.4 4.5c1.3 0 2.5-.6 3.3-1.5M11 1.5v3c0 .3-.2.5-.5.5h-3"})),De=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 24 24"},N.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),N.default.createElement("path",{fill:"currentColor",d:"M17 13h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"})),we=e=>N.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",...e,style:{height:e.height,width:e.width},viewBox:"0 0 24 24"},N.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),N.default.createElement("g",{fill:"none",fillRule:"evenodd"},N.default.createElement("path",{d:"m12.593 23.258-.011.002-.071.035-.02.004-.014-.004-.071-.035q-.016-.005-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427q-.004-.016-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093q.019.005.029-.008l.004-.014-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014-.034.614q.001.018.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z"}),N.default.createElement("path",{fill:"currentColor",d:"m12 14.122 5.303 5.303a1.5 1.5 0 0 0 2.122-2.122L14.12 12l5.304-5.303a1.5 1.5 0 1 0-2.122-2.121L12 9.879 6.697 4.576a1.5 1.5 0 1 0-2.122 2.12L9.88 12l-5.304 5.304a1.5 1.5 0 1 0 2.122 2.12z"}))),P=l(n()),q={container:"ColorsSubmenu-module__container___be--V_ledfxDcolorDsync",pills:"ColorsSubmenu-module__pills___aSSmw_ledfxDcolorDsync",active:"ColorsSubmenu-module__active___6cuQF_ledfxDcolorDsync",colors:"ColorsSubmenu-module__colors___yhZrU_ledfxDcolorDsync",padRight:"ColorsSubmenu-module__padRight___ScG0o_ledfxDcolorDsync"},z=l(n()),F={container:"ColorSelector-module__container___m57Fw_ledfxDcolorDsync",singleColor:"ColorSelector-module__singleColor___tJ9Gf_ledfxDcolorDsync",gradientColor:"ColorSelector-module__gradientColor___LtdRd_ledfxDcolorDsync",addIcon:"ColorSelector-module__addIcon___5oO4I_ledfxDcolorDsync",gradientPart:"ColorSelector-module__gradientPart___rYXk4_ledfxDcolorDsync",unsetText:"ColorSelector-module__unsetText___nqNDH_ledfxDcolorDsync"};function Se({colorKey:r,colorData:a,renderedColors:i,setColorData:c}){let t=void 0!==a;if(!i)return null;let l=(0,z.useRef)(null);var e=(0,z.useRef)(null);let[o,n]=(0,z.useState)(0),[s,d]=(0,z.useState)(!1);return z.default.createElement("div",{className:F.container},z.default.createElement("span",null,r.replace("_"," ")),"gradient"===r||"object"==typeof a?z.default.createElement("div",{className:F.gradientColor},z.default.createElement("div",{ref:l,style:{background:a?_(a,i)??"black":"black"},onMouseMove:e=>{var t=l.current?.getBoundingClientRect();t&&n(e.clientX-t.left-12.5)},onMouseEnter:e=>{e.currentTarget===e.target&&d(!0)},onMouseLeave:e=>{e.currentTarget===e.target&&d(!1)},onClick:e=>{return e=e,t=a?{...a}:{},l=e.currentTarget.getBoundingClientRect(),e=e.clientX-l.left,t[Math.round(e/l.width*100)]=0,void c(r,t);var t,l}},z.default.createElement("div",{ref:e,className:F.addIcon,style:{display:s?"block":"none",position:"absolute",left:o}},z.default.createElement(De,{height:25,width:25})),Object.keys(a??{}).length<2&&z.default.createElement("span",{className:F.unsetText},"Unset"),void 0!==a&&Object.entries(a).map(([o,n])=>{return z.default.createElement("div",{key:o,className:F.gradientPart,style:{left:`calc(${e=o,93*+e/100+2}% - 15px)`,background:_(n,i)??"black",color:u(i[n])??"white"},onClick:e=>{e.stopPropagation();var t,l,e=n+1>=i.length?0:n+1;t=o,e=e,(l=a?{...a}:{})[t]=e,c(r,l)}},z.default.createElement("div",{style:{background:_(n,i)??"black"}}),z.default.createElement("span",null,n+1),z.default.createElement("span",null,o,"%"),z.default.createElement("button",{onClick:e=>{var t;e.stopPropagation(),e=o,delete(t=a?{...a}:{})[e],c(r,t)},style:{color:u(i[n])??"white"}},z.default.createElement(we,{height:12,width:12})));var e}))):z.default.createElement("div",{className:F.singleColor,style:{backgroundColor:t?Q(...i[a]):"black",color:t?u(i[a]):"white",opacity:1},onClick:e=>{e.stopPropagation();e=t?a+1>=i.length?void 0:a+1:0;c(r,e)}},z.default.createElement("span",null,t?"Color #"+(a+1):"Unset")))}var Ce=Spicetify.classnames;function Me({data:o,setData:n,ledFx:t}){let l=re(),[r,a]=P.default.useState([]),i=(t,e)=>{e?a([...r,t]):a(r.filter(e=>e!==t))};var e=(0,P.useMemo)(()=>{if(0===r.length)return Object.keys(I);let l=[];return Object.entries(I).forEach(([e,t])=>{t.some(e=>r.includes(e))&&l.push(e)}),l},[r]);return P.default.createElement("div",{className:q.container},P.default.createElement("div",null,P.default.createElement("span",null,"Filters"),P.default.createElement("div",{className:q.pills},P.default.createElement("div",null,P.default.createElement("button",{onClick:async()=>{var e=await t.getEffect();if(e){let t=e.type;r.includes(t)?a(r.filter(e=>e!==t)):a([...r,t])}},className:q.active,title:"Auto-select curent effect"},P.default.createElement(ve,{width:20,height:20})),P.default.createElement("button",{onClick:()=>{a([])},className:Ce(q.active,q.padRight),title:"Reset effect filters"},P.default.createElement(be,{width:16,height:16})),Object.entries(A).sort(([e],[t])=>{e=r.includes(e);return e===r.includes(t)?0:e?-1:1}).map(([e,t])=>P.default.createElement(Ee,{key:t,checked:r.includes(e),effectName:t,effectValue:e,check:i}))))),P.default.createElement("div",{className:q.colors},e.map(e=>P.default.createElement(Se,{key:e,colorKey:e,colorData:o[e],renderedColors:l,setColorData:(e,t)=>{var l={...o};void 0===t?delete l[e]:l[e]=t,n(l)}}))))}function Ee({effectName:e,effectValue:t,check:l,checked:o}){return P.default.createElement("button",{onClick:()=>l(t,!o),className:Ce(o&&q.active)},e)}function ke({config:e,hasChanges:t,presetsChanged:l,selectedPresetChanged:o}){let n=le(e).configData;var r=(0,k.useMemo)(()=>new b(e),[]);let[a,i]=(0,k.useState)(null),[c,s]=(0,k.useState)(n.selectedPreset),[d,u]=(0,k.useState)(n.presets),_=d[c];(0,k.useEffect)(()=>{t||(u(n.presets),s(n.selectedPreset))},[t]),(0,k.useEffect)(()=>{l(d)},[d]),(0,k.useEffect)(()=>{o(c)},[c]);let[f,p]=(0,k.useState)(""),[g,m]=(0,k.useState)(""),h=()=>{"delete"===a?(()=>{let t=c;0!==t&&(u(e=>{e=[...e];return e.splice(t,1),e}),s(0))})():"add"===a?(u(e=>[...e,{name:f,colorData:{}}]),s(d.length)):"rename"===a&&u(e=>{e=[...e];return e[c].name=g,e}),i(null)};return k.default.createElement("div",{className:pe.container},k.default.createElement("div",{className:pe.select},"rename"===a?k.default.createElement(de,{value:g,setValue:m,label:"Rename Preset"}):"delete"===a?k.default.createElement(ue,{value:_.name,label:"Delete Preset"}):"add"===a?k.default.createElement(de,{value:f,setValue:p,label:"Add Preset"}):k.default.createElement(ce,{value:c.toString(),originalValue:"",options:d.map((e,t)=>({title:e.name,value:t.toString()})),objKey:"selectedPreset",setFn:(e,t)=>{s(parseInt(t))},label:"Active Preset",noNull:!0}),k.default.createElement("div",null,a?k.default.createElement(k.default.Fragment,null,k.default.createElement("button",{onClick:e=>{e.stopPropagation(),h()}},k.default.createElement(xe,{height:18,width:18})),k.default.createElement("button",{onClick:e=>{e.stopPropagation(),i(null)}},k.default.createElement(ye,{height:18,width:18}))):k.default.createElement(k.default.Fragment,null,k.default.createElement("button",{onClick:e=>{e.stopPropagation(),p("New Preset"),i("add")}},k.default.createElement(he,{height:18,width:18})),k.default.createElement("button",{onClick:e=>{e.stopPropagation(),m(_.name),i("rename")},disabled:0===c},k.default.createElement(ge,{height:18,width:18})),k.default.createElement("button",{onClick:e=>{e.stopPropagation(),i("delete")},disabled:0===c},k.default.createElement(me,{height:18,width:18}))))),k.default.createElement(Me,{data:_.colorData,setData:t=>{u(e=>{e=JSON.parse(JSON.stringify(e));return e[c].colorData=t,e})},ledFx:r}))}var L={deviceId:"Device",ledFxUrl:"LedFx URL",presets:"Presets",sortColors:"Sort colors by vibrance and lightness",debug:"Debug in console",selectedPreset:"Active Preset"};function Ne({config:e}){let{setValue:l,configData:t}=le(e);var o=re();let n=(0,y.useMemo)(()=>new b(e),[]),[r,a]=(0,y.useState)(t),[i,c]=(0,y.useState)(null),[s,d]=(0,y.useState)(null),u=(0,y.useMemo)(()=>Object.entries(t).reduce((e,[t,l])=>{var o=r[t];if(Array.isArray(o)){if(JSON.stringify(o)===JSON.stringify(l))return e}else if(o===l)return e;return e[t]=r[t],e},{}),[t,r]);var _=e=>{var t,l={};for(t of e)t in u&&(l[t]=u[t]);return l};let f=_(["ledFxUrl","deviceId"]);var p=0<Object.keys(f).length&&r.ledFxUrl;let g=_(["sortColors","selectedPreset","presets"]);var _=0<Object.keys(g).length,m=((0,y.useEffect)(()=>{(async()=>{let e=await n.listDevices();var t=(await n.listVirtuals())?.filter(t=>!e||!e.some(e=>e.id===t))||null;c(e),d(t)})()},[t.ledFxUrl,t.deviceId]),(t,l)=>{a(e=>({...e,[t]:l}))});let h=e=>{for(var t in e)l(t,e[t])};return y.default.createElement("div",{className:v.parent},y.default.createElement("h2",null,"Device"),y.default.createElement(se,{objKey:"ledFxUrl",value:r.ledFxUrl,setFn:m}),y.default.createElement(ce,{objKey:"deviceId",originalValue:t.deviceId,value:r.deviceId,options:(i?.map(e=>({title:e.name,subtitle:"Device with ID "+e.id,value:e.id}))??[]).concat(s?.map(e=>({title:e,subtitle:"Virtual device",value:e}))??[]),setFn:m,error:i?void 0:"No devices found, check LedFx URL/instance"}),y.default.createElement(Spicetify.ReactComponent.ButtonPrimary,{disabled:!p,onClick:()=>h(f)},"Save device config"),y.default.createElement("h2",null,"Colors"),y.default.createElement("h4",null,"Current Colors"),y.default.createElement("div",{className:v.colorDisplay},o?o.map((e,t)=>y.default.createElement("div",{key:t,style:{backgroundColor:x(...e),opacity:1}})):"No colors found"),y.default.createElement(fe,{objKey:"sortColors",value:r.sortColors,setFn:m}),y.default.createElement("h4",null,"Color Settings"),y.default.createElement(ke,{config:e,hasChanges:_,presetsChanged:t=>{a(e=>({...e,presets:t}))},selectedPresetChanged:t=>{a(e=>({...e,selectedPreset:t}))}}),y.default.createElement("span",{className:v.subtitle},"Note: After changing back to Unset, you still need to reset the color inside LedFx dashboard!"),y.default.createElement("div",{className:v.saveButtons},y.default.createElement(Spicetify.ReactComponent.ButtonPrimary,{disabled:!_,onClick:()=>h(g)},"Save color config"),y.default.createElement(Spicetify.ReactComponent.ButtonSecondary,{disabled:!_,onClick:()=>{a(t)}},"Reset color config")))}var Pe=l(n()),qe=class extends CustomEvent{constructor(e,t){super("LedFxConfigUpdated",{detail:{key:e,value:t}})}},O=class{constructor(){var t=Spicetify.LocalStorage.get("color-extractor-config");let l;if(t){l=JSON.parse(t);let e=!1;for(var o in O.defaults)o in l||(l[o]=O.defaults[o],e=!0);e&&Spicetify.LocalStorage.set(O.lsKey,JSON.stringify(l))}else Spicetify.LocalStorage.set(O.lsKey,JSON.stringify(O.defaults)),l=O.defaults;this.config=l}getAll(){return this.config}set(e,t){this.config[e]=t,Spicetify.LocalStorage.set(O.lsKey,JSON.stringify(this.config)),document.dispatchEvent(new qe(e,t))}get(e){return this.config[e]}},j=O,ze=(j.lsKey="color-extractor-config",j.defaults={deviceId:null,ledFxUrl:"http://127.0.0.1:8888/",sortColors:!0,debug:!1,presets:[{name:"Default",colorData:{gradient:{0:0,20:1,40:2,60:3,80:4,100:0},strobe_color:0}}],selectedPreset:0},class extends CustomEvent{constructor(e){super("albumColorUpdated",{detail:e})}}),Fe=function(){console.log("LedFX Color Extractor Loaded"),r();let n=new j,l=new b(n),e=document.createElement("div");var t,o;async function r(){var e,t=await async function t(l=0){var e=await W(".main-image-image.cover-art-image.main-image-loaded");if(!e)return null;try{var o=(new s).getPalette(e,5);return o?n.get("sortColors")?$(o,n.get("debug")):o:null}catch(e){return l<3?(console.error("Error extracting color, retrying..."),t(l+1)):(console.error("Error extracting color, giving up."),null)}}();t&&((e=n.get("deviceId"))&&l.setEffectColors(e,t),document.dispatchEvent(new ze(t)))}Spicetify.ReactDOM.render(Pe.default.createElement(Ne,{config:n}),e),t="Set up LedFx",o=()=>{Spicetify.PopupModal.display({title:"Set up LedFx",content:e,isLarge:!0})},new Spicetify.Menu.Item(t,!1,o,ee).register(),document.addEventListener("LedFxConfigUpdated",function(e){"sortColors"===e.detail.key&&r()}),Spicetify.Player.addEventListener("songchange",function(){setTimeout(r,500)})};(async()=>{await Fe()})(),(async()=>{var e;document.getElementById("ledfxDcolorDsync")||((e=document.createElement("style")).id="ledfxDcolorDsync",e.textContent=String.raw`
  .SettingsModal-module__input___v8E2s_ledfxDcolorDsync{background-color:var(--spice-highlight-elevated)!important}.SettingsModal-module__parent___oVk1A_ledfxDcolorDsync{display:flex;flex-direction:column;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync{display:flex;flex-direction:row;justify-content:center;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync label{width:30%;max-width:30%;display:flex;align-items:center}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync{display:flex;gap:20px;padding:0 5px}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync>div{width:30px;height:30px;border-radius:50%;outline:1px solid white;outline-offset:2px}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync{display:flex;gap:10px;padding:0 5px;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>label{display:flex;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:22px;height:22px;border:2px solid var(--spice-button,#292a2e);border-radius:4px;position:relative;cursor:pointer;background-color:color-mix(in srgb,var(--spice-button,#292a2e) 20%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked{border-color:var(--spice-button-active,#3f4146);background-color:color-mix(in srgb,var(--spice-button-active,#292a2e) 40%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked::before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-45deg);width:10px;height:5px;border-left:2px solid var(--spice-button-active,#3f4146);border-bottom:2px solid var(--spice-button-active,#3f4146)}.SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync{font-size:13px;opacity:.6}.SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync{display:flex;justify-content:center;align-items:center;gap:10px}.SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync{cursor:default}.SettingsModal-module__field___qw0nl_ledfxDcolorDsync{padding-left:16px}.SettingsModal-module__input___v8E2s_ledfxDcolorDsync{background-color:var(--spice-highlight-elevated)!important}.SettingsModal-module__parent___oVk1A_ledfxDcolorDsync{display:flex;flex-direction:column;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync{display:flex;flex-direction:row;justify-content:center;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync label{width:30%;max-width:30%;display:flex;align-items:center}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync{display:flex;gap:20px;padding:0 5px}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync>div{width:30px;height:30px;border-radius:50%;outline:1px solid white;outline-offset:2px}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync{display:flex;gap:10px;padding:0 5px;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>label{display:flex;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:22px;height:22px;border:2px solid var(--spice-button,#292a2e);border-radius:4px;position:relative;cursor:pointer;background-color:color-mix(in srgb,var(--spice-button,#292a2e) 20%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked{border-color:var(--spice-button-active,#3f4146);background-color:color-mix(in srgb,var(--spice-button-active,#292a2e) 40%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked::before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-45deg);width:10px;height:5px;border-left:2px solid var(--spice-button-active,#3f4146);border-bottom:2px solid var(--spice-button-active,#3f4146)}.SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync{font-size:13px;opacity:.6}.SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync{display:flex;justify-content:center;align-items:center;gap:10px}.SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync{cursor:default}.SettingsModal-module__field___qw0nl_ledfxDcolorDsync{padding-left:16px}.SettingsModal-module__input___v8E2s_ledfxDcolorDsync{background-color:var(--spice-highlight-elevated)!important}.SettingsModal-module__parent___oVk1A_ledfxDcolorDsync{display:flex;flex-direction:column;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync{display:flex;flex-direction:row;justify-content:center;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync label{width:30%;max-width:30%;display:flex;align-items:center}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync{display:flex;gap:20px;padding:0 5px}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync>div{width:30px;height:30px;border-radius:50%;outline:1px solid white;outline-offset:2px}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync{display:flex;gap:10px;padding:0 5px;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>label{display:flex;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:22px;height:22px;border:2px solid var(--spice-button,#292a2e);border-radius:4px;position:relative;cursor:pointer;background-color:color-mix(in srgb,var(--spice-button,#292a2e) 20%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked{border-color:var(--spice-button-active,#3f4146);background-color:color-mix(in srgb,var(--spice-button-active,#292a2e) 40%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked::before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-45deg);width:10px;height:5px;border-left:2px solid var(--spice-button-active,#3f4146);border-bottom:2px solid var(--spice-button-active,#3f4146)}.SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync{font-size:13px;opacity:.6}.SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync{display:flex;justify-content:center;align-items:center;gap:10px}.SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync{cursor:default}.SettingsModal-module__field___qw0nl_ledfxDcolorDsync{padding-left:16px}.SettingsModal-module__input___v8E2s_ledfxDcolorDsync{background-color:var(--spice-highlight-elevated)!important}.SettingsModal-module__parent___oVk1A_ledfxDcolorDsync{display:flex;flex-direction:column;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync{display:flex;flex-direction:row;justify-content:center;gap:20px}.SettingsModal-module__inputContainer___yzMUi_ledfxDcolorDsync label{width:30%;max-width:30%;display:flex;align-items:center}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync{display:flex;gap:20px;padding:0 5px}.SettingsModal-module__colorDisplay___Npkyr_ledfxDcolorDsync>div{width:30px;height:30px;border-radius:50%;outline:1px solid white;outline-offset:2px}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync{display:flex;gap:10px;padding:0 5px;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>label{display:flex;align-items:center}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:22px;height:22px;border:2px solid var(--spice-button,#292a2e);border-radius:4px;position:relative;cursor:pointer;background-color:color-mix(in srgb,var(--spice-button,#292a2e) 20%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked{border-color:var(--spice-button-active,#3f4146);background-color:color-mix(in srgb,var(--spice-button-active,#292a2e) 40%,transparent)}.SettingsModal-module__toggle___aHQ-b_ledfxDcolorDsync>input[type=checkbox]:checked::before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-45deg);width:10px;height:5px;border-left:2px solid var(--spice-button-active,#3f4146);border-bottom:2px solid var(--spice-button-active,#3f4146)}.SettingsModal-module__subtitle___ft0sm_ledfxDcolorDsync{font-size:13px;opacity:.6}.SettingsModal-module__saveButtons___grrPZ_ledfxDcolorDsync{display:flex;justify-content:center;align-items:center;gap:10px}.SettingsModal-module__staticField___00ZYL_ledfxDcolorDsync{cursor:default}.SettingsModal-module__field___qw0nl_ledfxDcolorDsync{padding-left:16px}.ColorsConfigMenu-module__container___A-ZV8_ledfxDcolorDsync{display:flex;flex-direction:column;gap:20px}.ColorsConfigMenu-module__select___byko-_ledfxDcolorDsync{width:100%;display:flex;gap:10px}.ColorsConfigMenu-module__select___byko-_ledfxDcolorDsync>:first-child{flex:1}.ColorsConfigMenu-module__select___byko-_ledfxDcolorDsync>:first-child label{width:200px}.ColorsConfigMenu-module__select___byko-_ledfxDcolorDsync>:last-child{position:relative;height:32px;min-width:116px;display:flex;gap:10px}.ColorsConfigMenu-module__select___byko-_ledfxDcolorDsync>:last-child>button{height:100%;width:32px;display:grid;place-items:center;border-radius:4px;border:none;background-color:var(--spice-highlight-elevated,#292a2e)}.ColorsConfigMenu-module__select___byko-_ledfxDcolorDsync>:last-child>button:disabled{opacity:.5}.ColorsConfigMenu-module__staticInput___gUq2H_ledfxDcolorDsync{background-color:var(--spice-highlight-elevated)!important}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync{background-color:var(--spice-highlight-elevated)!important;padding:5px 20px 20px 20px;border-radius:4px;height:300px;color:rgba(var(--spice-rgb-selected-row,#fff),.7);display:flex;flex-direction:column;gap:20px}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync>:first-child{display:flex;align-items:center;gap:10px}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync>:first-child>span{margin-top:15px}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync>:first-child .ColorsSubmenu-module__pills___aSSmw_ledfxDcolorDsync{transform:rotateX(180deg)!important;overflow-x:auto;scrollbar-width:thin}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync>:first-child .ColorsSubmenu-module__pills___aSSmw_ledfxDcolorDsync::-webkit-scrollbar-thumb{border-radius:9999px}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync>:first-child .ColorsSubmenu-module__pills___aSSmw_ledfxDcolorDsync>div{transform:rotateX(180deg);flex:1;display:flex;gap:6px;padding:5px 5px 0 5px}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync>:first-child .ColorsSubmenu-module__pills___aSSmw_ledfxDcolorDsync>div>button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;cursor:pointer;white-space:nowrap;font-size:12px;padding:2px 6px;border:1px solid rgba(var(--spice-rgb-selected-row,#fff),.7);border-radius:9999px;display:grid;place-items:center}.ColorsSubmenu-module__container___be--V_ledfxDcolorDsync>:first-child .ColorsSubmenu-module__pills___aSSmw_ledfxDcolorDsync>div>button.ColorsSubmenu-module__active___6cuQF_ledfxDcolorDsync{background-color:rgba(var(--spice-rgb-selected-row,#fff),.7);color:var(--spice-highlight-elevated)}.ColorsSubmenu-module__colors___yhZrU_ledfxDcolorDsync{padding:10px 0;flex:1;overflow-y:scroll;display:flex;flex-direction:column;gap:10px}.ColorsSubmenu-module__padRight___ScG0o_ledfxDcolorDsync{margin-right:5px}.ColorSelector-module__container___m57Fw_ledfxDcolorDsync{display:flex;justify-content:space-between;align-items:center;padding-right:15px;min-height:50px}.ColorSelector-module__singleColor___tJ9Gf_ledfxDcolorDsync{width:285px;margin-right:15px;height:30px;display:grid;place-items:center;border-radius:9999px;cursor:pointer;transition:transform .2s;outline:1px solid white;outline-offset:2px}.ColorSelector-module__singleColor___tJ9Gf_ledfxDcolorDsync span{font-weight:900}.ColorSelector-module__gradientColor___LtdRd_ledfxDcolorDsync{margin-top:-15px;position:relative;width:300px;height:30px}.ColorSelector-module__gradientColor___LtdRd_ledfxDcolorDsync>div:first-child{border-radius:9999px;outline:1px solid white;outline-offset:2px;cursor:pointer;width:95%;height:11px}.ColorSelector-module__addIcon___5oO4I_ledfxDcolorDsync{position:absolute;left:0;top:-7px;color:#000;z-index:3;width:25px;height:25px;display:grid;place-items:center;pointer-events:none}.ColorSelector-module__addIcon___5oO4I_ledfxDcolorDsync svg{background-color:#fff;clip-path:circle(48% at 50% 50%)}.ColorSelector-module__gradientPart___rYXk4_ledfxDcolorDsync{position:absolute;top:15px;left:0;width:25px;max-width:32px;height:40px;clip-path:polygon(50% 0,100% 40%,100% 100%,0 100%,0 40%);display:flex;flex-direction:column;align-items:center;padding-top:6px}.ColorSelector-module__gradientPart___rYXk4_ledfxDcolorDsync span{margin-top:-3px;font-size:11px;font-weight:900}.ColorSelector-module__gradientPart___rYXk4_ledfxDcolorDsync span:nth-of-type(2){font-size:9px}.ColorSelector-module__gradientPart___rYXk4_ledfxDcolorDsync button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;display:grid;place-items:center;cursor:pointer;margin-top:-2px;height:12px;width:12px}.ColorSelector-module__unsetText___nqNDH_ledfxDcolorDsync{color:#fff;position:absolute;top:50%;left:50%;transform:translate(-65%,-97%);padding:0 5px;font-size:15px;border-radius:9999px;pointer-events:none}
      `.trim(),document.head.appendChild(e))})()})();